
CREATE OR REPLACE VIEW STUDENT_PROPOSAL_MARKS AS
SELECT YEAR, STUDENT, ROUND(AVG(MARK),0)
FROM PROJ_PROPOSAL_EXAMINER_MARKS
WHERE MARK IS NOT NULL
GROUP BY STUDENT, YEAR
-- HAVING MIN(MARK) >= 0 --TEST
--THINK OF SOMETHING IF ITHIS JUST IGNORES NULL
--WE WANT TO REMOVE ALL THE ROWS WITH SAME STUDENT IF ONE IS NULL

CREATE OR REPLACE VIEW STUDENT_RECORD_MARKS AS
SELECT YEAR, STUDENT, ROUND(AVG(MARK),0)
FROM PROJ_REPORT_EXAMINER_MARKS
WHERE MARK IS NOT NULL
GROUP BY STUDENT, YEAR
-- HAVING MIN(MARK) >= 0 --TEST


--TO HIDE THE VIEWS FROM OTHER STUDENTS
CREATE OR REPLACE VIEW PROJ_PROPOSAL_MARKS AS
SELECT *
FROM STUDENT_PROPOSAL_MARKS
WHERE STUDENT = USER OR USER IN (SELECT * FROM PROJ_EXAMINERS);

SELECT * 
FROM PROJ_PROPOSAL_MARKS

CREATE OR REPLACE VIEW PROJ_REPORT_MARKS AS
SELECT *
FROM STUDENT_REPORT_MARKS
WHERE STUDENT = USER OR USER IN (SELECT * FROM PROJ_EXAMINERS);

SELECT *
FROM PROJ_PROPOSAL_MARKS